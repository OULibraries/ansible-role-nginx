---

- name: Nginx cache directory exists
  file:
    path: /var/lib/nginx/cache
    state: directory
    owner: nginx
    group: nginx

- name: Diffie Hellman ephemeral parameters
  command: openssl dhparam -out dhparam.pem 4096
  args:
    chdir: "{{ nginx_cert_path }}"
    creates: "{{ nginx_cert_path }}/dhparam.pem"

- name: Nginx Config
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
    mode: 0644
    owner: root
    group: wheel
